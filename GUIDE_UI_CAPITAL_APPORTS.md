# ğŸ“± Guide d'Affichage UI - Capital Investi vs Apports RÃ©els

**Objectif :** Utiliser le flag `isAutoGenerated` pour une prÃ©sentation claire et comprÃ©hensible

---

## ğŸ¯ Principes Fondamentaux

### Ã‰quation de Base
```
Apports RÃ©els + Gains/Pertes = Valeur Totale du Portefeuille
```

OÃ¹ :
- **Apports RÃ©els** = DÃ©pÃ´ts manuels - Retraits
- **Capital Investi** = Somme des achats (en valeur absolue)
- **Gains/Pertes** = IntÃ©rÃªts + Dividendes + Variation de prix des actifs

### Flag `isAutoGenerated`
- âœ… `true` â†’ DÃ©pÃ´t auto-gÃ©nÃ©rÃ© (ğŸ¤–) pour compensation
- âœ… `false` â†’ Transaction manuelle (utilisateur ou import rÃ©el)

---

## ğŸ“Š Recommandations d'Affichage

### 1. Liste des Transactions

#### DÃ©pÃ´t Manuel
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DÃ‰PÃ”T | 15 janvier 2025         â”‚
â”‚ Virement SEPA                   â”‚
â”‚ +1 500,00 â‚¬                     â”‚
â”‚                                 â”‚
â”‚ Notes: DÃ©pÃ´t personnel          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### DÃ©pÃ´t Auto-GÃ©nÃ©rÃ©
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– APPORT AUTO | 15 janvier     â”‚
â”‚ Compensation de l'import        â”‚
â”‚ +1 500,00 â‚¬                     â”‚
â”‚                                 â”‚
â”‚ DÃ©tail: Achat Apple 10@150â‚¬     â”‚
â”‚ Mode: Import initial            â”‚
â”‚ Source: trade_republic          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**DiffÃ©rences visuelles :**
- Badge ğŸ¤– en dÃ©but de titre
- IcÃ´ne de couleur diffÃ©rente (gris clair)
- Section "DÃ©tail" optionnelle mais recommandÃ©e
- Font lÃ©gÃ¨rement plus lÃ©gÃ¨re (moins important)

---

### 2. RÃ©sumÃ© du Portefeuille

#### Vue Simple (DÃ©faut)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PORTEFEUILLE                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Capital Investi:        8 500 â‚¬  â”‚
â”‚ â”œâ”€ Achat Apple (10):    1 500 â‚¬  â”‚
â”‚ â”œâ”€ Achat Microsoft (5): 1 000 â‚¬  â”‚
â”‚ â”œâ”€ Achat Tesla (2):     4 000 â‚¬  â”‚
â”‚ â””â”€ Achat BTC (0.1):     2 000 â‚¬  â”‚
â”‚                                  â”‚
â”‚ LiquiditÃ©s:               500 â‚¬   â”‚
â”‚ Valeur Totale:         8 500 â‚¬   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Vue DÃ©taillÃ©e (Avec DÃ©tails)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PORTEFEUILLE                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Apports RÃ©els (Manuels)  1 000 â‚¬ â”‚
â”‚ Capital Investi          8 500 â‚¬  â”‚
â”‚ â”œâ”€ Apports auto comp:    7 500 â‚¬  â”‚
â”‚ â”‚  (Compensation imports) ğŸ¤–      â”‚
â”‚ â””â”€ Achats rÃ©els:         1 000 â‚¬  â”‚
â”‚                                  â”‚
â”‚ IntÃ©rÃªts/Dividendes       150 â‚¬   â”‚
â”‚ Gains/Pertes Latents      500 â‚¬   â”‚
â”‚ Retraits EffectuÃ©s       (500 â‚¬)  â”‚
â”‚                                  â”‚
â”‚ LiquiditÃ©s Actuelles      150 â‚¬   â”‚
â”‚ Valeur Totale Actif    8 500 â‚¬   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3. Ã‰tat Financier Complet

#### Tableau de RÃ©conciliation (Optionnel)

```
RÃ‰CONCILIATION DU CAPITAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¥ APPORTS NETS
  DÃ©pÃ´ts manuels:          +10 000 â‚¬
  Retraits:                 -2 000 â‚¬
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Apports nets:             +8 000 â‚¬

ğŸ’¼ CAPITAL INVESTI
  Achats (Buy):             -8 500 â‚¬
  Ventes (Sell):            +1 500 â‚¬
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Capital net investi:      -7 000 â‚¬

ğŸ“Š RENDEMENTS
  IntÃ©rÃªts:                   +150 â‚¬
  Dividendes:                 +250 â‚¬
  Gains latents:              +600 â‚¬
  Frais:                      -100 â‚¬
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Rendements nets:            +900 â‚¬

ğŸ¤– COMPENSATION IMPORTS
  DÃ©pÃ´ts auto (15/01):      -7 000 â‚¬ (isAutoGenerated=true)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SOLDE FINAL:    8000 + (-7000) + 900 + (-7000) = -5100 â‚¬
                (ERREUR : rÃ©conciliation Ã©chouÃ©e)
```

**âš ï¸ Attention :** Cette vue est pour audit/debug uniquement. Dans la plupart des cas, vous n'aurez PAS besoin de l'afficher car :
- La compensation auto ne crÃ©e que des 0
- Le solde final = Apports nets + Rendements

---

## ğŸ”„ Logique de Filtrage (Code UI)

### Afficher UNIQUEMENT les Apports RÃ©els
```dart
final realDeposits = account.transactions
  .where((t) => t.type == TransactionType.Deposit && !t.isAutoGenerated)
  .toList();

print('Apports rÃ©els: ${realDeposits.fold(0.0, (sum, t) => sum + t.amount)}â‚¬');
// Output: "Apports rÃ©els: 10000â‚¬"
```

### Calculer le Capital Investi
```dart
final capitalInvested = account.transactions
  .where((t) => t.type == TransactionType.Buy)
  .fold(0.0, (sum, t) => sum + t.amount.abs());

print('Capital investi: ${capitalInvested}â‚¬');
// Output: "Capital investi: 8500â‚¬"
```

### Afficher les DÃ©pÃ´ts Auto (Statistiques)
```dart
final autoDeposits = account.transactions
  .where((t) => t.type == TransactionType.Deposit && t.isAutoGenerated)
  .fold(0.0, (sum, t) => sum + t.amount);

print('Compensation imports: ${autoDeposits}â‚¬');
// Output: "Compensation imports: 7500â‚¬"
```

### LiquiditÃ©s CohÃ©rentes
```dart
final liquidities = account.transactions.fold(0.0, (sum, t) {
  // Ne compter que les dÃ©pÃ´ts manuels et retraits
  // Les auto-dÃ©pÃ´ts compensent les achats (0 net)
  if (t.type == TransactionType.Deposit && t.isAutoGenerated) {
    return sum; // Ignorer
  }
  return sum + t.amount;
});

print('LiquiditÃ©s actuelles: ${liquidities}â‚¬');
```

---

## ğŸ¨ Recommandations Design

### Couleurs/Styles SuggÃ©rÃ©s

| Ã‰lÃ©ment | Style | Exemple |
|---------|-------|---------|
| DÃ©pÃ´t manuel | Vert/Normal | ğŸŸ¢ +1500â‚¬ |
| Auto-dÃ©pÃ´t | Gris/Italique | ğŸ¤– +1500â‚¬ _(grisÃ©)_ |
| Achat | Rouge/Normal | ğŸ”´ -1500â‚¬ |
| Vente | Vert/Normal | ğŸŸ¢ +1500â‚¬ |
| Retrait | Rouge/Normal | ğŸ”´ -500â‚¬ |

### IcÃ´nes

```
ğŸŸ¢  DÃ©pÃ´t / Vente / IntÃ©rÃªts        (augmente liquiditÃ©s)
ğŸ”´  Achat / Retrait / Frais         (diminue liquiditÃ©s)
ğŸ¤–  DÃ©pÃ´t auto-gÃ©nÃ©rÃ©              (compensation technique)
ğŸ’¼  Capital investi / Positions     (actifs en portefeuille)
ğŸ“Š  Rendement / Gains               (plus-values)
```

---

## âœ… Exemples Complets

### Cas 1 : Import Initial Trade Republic

**Fichier importÃ© :**
```
15/01/2025 | Achat AAPL | -1500â‚¬
```

**Transactions crÃ©Ã©es :**
1. `Transaction` (Buy, -1500â‚¬, isAutoGenerated=false)
   - Notes: "Import initial depuis trade_republic"
   - Affichage: ğŸ”´ ACHAT AAPL | -1500â‚¬

2. `Transaction` (Deposit, +1500â‚¬, isAutoGenerated=true)
   - Notes: "ğŸ¤– Apport auto - Neutralisation..."
   - Affichage: ğŸ¤– APPORT AUTO | +1500â‚¬ _(grisÃ©)_

**Analyse :**
- Apports rÃ©els = 0â‚¬ (pas de vrai dÃ©pÃ´t manuel)
- Capital investi = 1500â‚¬ (achat)
- LiquiditÃ©s finales = 0â‚¬ (Ã©quilibrÃ©)

### Cas 2 : Import + Retrait

**Fichier importÃ© :**
```
15/01/2025 | Achat AAPL       | -1500â‚¬
20/01/2025 | Retrait bancaire | -500â‚¬
```

**Transactions crÃ©Ã©es :**
1. `Transaction` (Buy, -1500â‚¬, isAutoGenerated=false)
2. `Transaction` (Withdrawal, -500â‚¬, isAutoGenerated=false)
3. `Transaction` (Deposit, +2000â‚¬, isAutoGenerated=true)
   - Notes: "ğŸ¤– Apport auto...\nAchat: AAPL 10@150â‚¬\nRetrait: 500â‚¬\nMontant: 2000â‚¬"

**Analyse :**
- Apports rÃ©els = 0â‚¬
- Capital investi = 1500â‚¬
- Retraits = 500â‚¬
- LiquiditÃ©s finales = 0â‚¬ (tous compensÃ©s)

### Cas 3 : DÃ©pÃ´t Manuel + Achat

**Manuel :**
```
10/01/2025 | Virement SEPA  | +5000â‚¬
15/01/2025 | Achat AAPL     | -1500â‚¬
```

**Transactions (depuis UI manuelle + import) :**
1. `Transaction` (Deposit, +5000â‚¬, isAutoGenerated=false)
   - Notes: "DÃ©pÃ´t personnel"
   - Affichage: ğŸŸ¢ DÃ‰PÃ”T | +5000â‚¬

2. `Transaction` (Buy, -1500â‚¬, isAutoGenerated=false)
   - Notes: "Import initial depuis trade_republic"
   - Affichage: ğŸ”´ ACHAT AAPL | -1500â‚¬

3. `Transaction` (Deposit, +1500â‚¬, isAutoGenerated=true)
   - Affichage: ğŸ¤– APPORT AUTO | +1500â‚¬ _(grisÃ©)_

**Analyse :**
- Apports rÃ©els = +5000â‚¬ (dÃ©pÃ´t manuel)
- Capital investi = 1500â‚¬
- LiquiditÃ©s finales = 3500â‚¬ (5000 - 1500)

---

## ğŸ“ Notes Importantes

### Qu'Est-ce qu'on Affiche Toujours ?

**OUI (afficher) :**
- Apports rÃ©els (manuels)
- Achats et ventes
- Retraits rÃ©els
- IntÃ©rÃªts et dividendes
- DÃ©pÃ´ts auto (mais grisÃ©s/marquÃ©s ğŸ¤–)

**NON (optionnel, cachÃ© par dÃ©faut) :**
- DÃ©tails mathÃ©matiques de rÃ©conciliation
- Trace complÃ¨te des compensations

### Implicites MathÃ©matiques

```
Capital = Apports RÃ©els + Rendements
        = (DÃ©pÃ´ts - Retraits) + (IntÃ©rÃªts + Gains)
        = (sans dÃ©pÃ´ts auto)
```

Les dÃ©pÃ´ts auto sont **invisibles du point de vue utilisateur** sauf s'il choisit de voir les dÃ©tails.

---

**Auteur:** GitHub Copilot  
**Version:** 1.0  
**Date:** 29 dÃ©cembre 2025  
**Status:** ğŸ“‹ Recommandations pour dÃ©veloppeurs UI/UX
